<link rel="import" href="../../polymer/polymer.html">

<polymer-element name="hi-step" extends="hi-base" hi-step>
    <script>
        Polymer({
            ready: function() {
                this.super();

                // initialize state of substeps to 'future'
                var substeps = $$(".substep", this);
                if (substeps){
                    substeps.forEach(function (sub){
                       sub.classList.add("future");
                    });
                }
            },
            domReady: function () {
                this.fire('high-impress:stepInitialized');
            },
            nextSubstep: function (){
                var lastSubsteps = $$('.substep.present', this);
                if (lastSubsteps) {
                    lastSubsteps.forEach(function (lastSubstep){
                        lastSubstep.classList.remove("present");
                        lastSubstep.classList.add("past");
                    });
                }

                var substep = $('.substep.future', this);
                var substeps = $$('.substep.future', this);

                if (substep) {
                    if (substep.dataset.group) {
                        var groupid = substep.dataset.group;
                        substeps.forEach(function (sub) {
                            if (sub.dataset.group && sub.dataset.group == groupid) {
                                sub.classList.remove("future");
                                sub.classList.add("present");
                            }
                        });
                    }
                    else {
                        substep.classList.remove("future");
                        substep.classList.add("present");
                    }
                    return true;
                }
                return false;
            }
        });
    </script>
</polymer-element>

